<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>本地apollo配置编辑器</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4CAF50">
</head>
<body>
    <div id="app">
        <!-- 在线模式提示 -->
        <div id="onlineModeBanner" class="online-mode-banner hidden">
            <div class="banner-content">
                <div class="banner-icon">⚠️</div>
                <div class="banner-text">
                    <div class="banner-title">当前为在线模式</div>
                    <div class="banner-details">
                        <div>• 不支持修改操作</div>
                        <div>• 修改不会生效</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 应用安装提示 -->
        <div id="installPrompt" class="install-prompt hidden">
            <div class="install-prompt-content">
                <div class="install-prompt-icon">📱</div>
                <div class="install-prompt-text">
                    <div class="install-prompt-title">将应用添加到桌面</div>
                    <div class="install-prompt-description">获得更好的使用体验</div>
                </div>
                <div class="install-prompt-buttons">
                    <button id="installBtn" class="install-btn">添加</button>
                    <button id="dismissInstallBtn" class="dismiss-btn">关闭</button>
                </div>
            </div>
        </div>
        
        <!-- 顶部栏 -->
        <header class="header">
            <h1 class="title">本地apollo配置编辑器</h1>
            <div class="header-buttons">
                <button id="refreshBtn" class="header-btn" title="刷新配置">
                    <span class="btn-icon">↻</span>
                </button>
                <button id="closeBtn" class="header-btn" title="关闭窗口">
                    <span class="btn-icon">×</span>
                </button>
            </div>
        </header>

        <!-- 配置卡片容器 -->
        <main class="main-content">
            <div id="configGrid" class="config-grid"></div>
        </main>

        <!-- 底部栏 -->
        <footer class="footer">
            <div class="footer-left">
                <span id="pathLabel" class="path-label" title="点击指定opt目录">
                    当前配置路径: C:/opt/data
                </span>
            </div>
            <div class="footer-right">
                <span id="envLabel" class="env-label" title="点击切换环境">
                    在线
                </span>
            </div>
        </footer>

        <!-- 配置详情模态框 -->
        <div id="configDetailsModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalTitle">配置详情</h2>
                    <button id="closeModalBtn" class="modal-close-btn">×</button>
                </div>
                <div class="modal-body">
                    <div id="configFilesGrid" class="config-files-grid"></div>
                </div>
            </div>
        </div>

        <!-- 配置编辑模态框 -->
        <div id="configEditorModal" class="modal hidden">
            <div class="modal-content editor-modal">
                <div class="modal-header">
                    <div class="modal-header-left">
                        <h2 id="editorTitle">编辑配置</h2>
                        <span id="unsavedIndicator" class="unsaved-indicator hidden">
                            <span class="unsaved-dot"></span> 未保存
                        </span>
                    </div>
                    <div class="editor-buttons">
                        <button id="saveBtn" class="editor-btn save-btn">保存</button>
                        <button id="searchBtn" class="editor-btn search-btn">搜索</button>
                        <button id="addBtn" class="editor-btn add-btn">添加</button>
                        <button id="closeEditorBtn" class="modal-close-btn">×</button>
                    </div>
                </div>
                
                <!-- 搜索栏 -->
                <div id="searchBar" class="search-bar hidden">
                    <input type="text" id="searchInput" placeholder="搜索属性名或属性值..." class="search-input">
                    <div class="search-nav">
                        <button id="prevBtn" class="search-nav-btn">上一个</button>
                        <button id="nextBtn" class="search-nav-btn">下一个</button>
                        <span id="searchResult" class="search-result">找到 0 个结果</span>
                    </div>
                </div>
                
                <!-- 配置编辑表格 -->
                <div class="modal-body">
                    <table id="configTable" class="config-table">
                        <thead>
                            <tr>
                                <th>属性名</th>
                                <th>属性值</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="configTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // 注册Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then((registration) => {
                        console.log('Service Worker 注册成功:', registration.scope);
                    })
                    .catch((error) => {
                        console.error('Service Worker 注册失败:', error);
                    });
            });
        }
    </script>
</body>
</html>